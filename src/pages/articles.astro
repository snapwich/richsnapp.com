---
import { getCollection } from "astro:content";
import BasicPage from "layouts/BasicPage.astro";
import { parseSlugDate } from "utils/date";
import PostPreviewList from "components/PostPreviewList.astro";

const blogPosts = await getCollection("blog");
const articlePosts = await getCollection("article");

const articlePostsSorted = articlePosts.sort(
  (a, b) =>
    parseSlugDate(b.id).date.valueOf() - parseSlugDate(a.id).date.valueOf(),
);
const combinedPosts = [...blogPosts, ...articlePosts];

const tagSet = combinedPosts.reduce((memo, post) => {
  for (let tag of post.data.tags) {
    memo.add(tag);
  }
  return memo;
}, new Set<string>());
const allTags = Array.from(tagSet).sort();
---

<BasicPage title="Articles">
  <PostPreviewList posts={articlePostsSorted} />
</BasicPage>
